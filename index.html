<!--

    Assembly
    Baseline
    Computer
    40


-->

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ABC40</title>
    <link rel="stylesheet" href="main.css">
    <link rel="shortcut icon" href="assets/abc40logo.png" type="image/x-icon">
    <script src="computer.js"></script>
</head>
<body>

    <h2>Assembly Baseline Computer 40</h2>
    <div class="container">
        
        <div>
            <h3>Register view</h3>
            <label>00</label>
            <textarea cols="5" rows="1" disabled id="mem0" class="registerDisplay">000000</textarea>
            <br>
            <label>01</label>
            <textarea cols="5" rows="1" disabled id="mem1" class="registerDisplay">000000</textarea>
            <br>
            <label>02</label>
            <textarea cols="5" rows="1" disabled id="mem2" class="registerDisplay">000000</textarea>
            <br>
            <label>03</label>
            <textarea cols="5" rows="1" disabled id="mem3" class="registerDisplay">000000</textarea>
            <br>
            <label>04</label>
            <textarea cols="5" rows="1" disabled id="mem4" class="registerDisplay">000000</textarea>
            <br>
            <label>05</label>
            <textarea cols="5" rows="1" disabled id="mem5" class="registerDisplay">000000</textarea>
            <br>
            <label>06</label>
            <textarea cols="5" rows="1" disabled id="mem6" class="registerDisplay">000000</textarea>
            <br>
            <label>07</label>
            <textarea cols="5" rows="1" disabled id="mem7" class="registerDisplay">000000</textarea>
            <br>
            <label>08</label>
            <textarea cols="5" rows="1" disabled id="mem8" class="registerDisplay">000000</textarea>
            <br>
            <label>09</label>
            <textarea cols="5" rows="1" disabled id="mem9" class="registerDisplay">000000</textarea>
            <br>
            <label>0A</label>
            <textarea cols="5" rows="1" disabled id="mem10" class="registerDisplay">000000</textarea>
            <br>
            <label>0B</label>
            <textarea cols="5" rows="1" disabled id="mem11" class="registerDisplay">000000</textarea>
            <br>
            <label>0C</label>
            <textarea cols="5" rows="1" disabled id="mem12" class="registerDisplay">000000</textarea>
            <br>
            <label>0D</label>
            <textarea cols="5" rows="1" disabled id="mem13" class="registerDisplay">000000</textarea>
            <br>
            <label>0E</label>
            <textarea cols="5" rows="1" disabled id="mem14" class="registerDisplay">000000</textarea>
            <br>
            <label>0F</label>
            <textarea cols="5" rows="1" disabled id="mem15" class="registerDisplay">000000</textarea>
            <br>
            
        </div>
        <div>
            <h3 style="color: #cacaca;">.</h3>
            <label>10</label>
            <textarea cols="5" rows="1" disabled id="mem16" class="registerDisplay">000000</textarea>
            <br>
            <label>11</label>
            <textarea cols="5" rows="1" disabled id="mem17" class="registerDisplay">000000</textarea>
            <br>
            <label>12</label>
            <textarea cols="5" rows="1" disabled id="mem18" class="registerDisplay">000000</textarea>
            <br>
            <label>13</label>
            <textarea cols="5" rows="1" disabled id="mem19" class="registerDisplay">000000</textarea>
            <br>
            <label>14</label>
            <textarea cols="5" rows="1" disabled id="mem20" class="registerDisplay">000000</textarea>
            <br>
            <label>15</label>
            <textarea cols="5" rows="1" disabled id="mem21" class="registerDisplay">000000</textarea>
            <br>
            <label>16</label>
            <textarea cols="5" rows="1" disabled id="mem22" class="registerDisplay">000000</textarea>
            <br>
            <label>17</label>
            <textarea cols="5" rows="1" disabled id="mem23" class="registerDisplay">000000</textarea>
            <br>
            <label>18</label>
            <textarea cols="5" rows="1" disabled id="mem24" class="registerDisplay">000000</textarea>
            <br>
            <label>19</label>
            <textarea cols="5" rows="1" disabled id="mem25" class="registerDisplay">000000</textarea>
            <br>
            <label>1A</label>
            <textarea cols="5" rows="1" disabled id="mem26" class="registerDisplay">000000</textarea>
            <br>
            <label>1B</label>
            <textarea cols="5" rows="1" disabled id="mem27" class="registerDisplay">000000</textarea>
            <br>
            <label>1C</label>
            <textarea cols="5" rows="1" disabled id="mem28" class="registerDisplay">000000</textarea>
            <br>
            <label>1D</label>
            <textarea cols="5" rows="1" disabled id="mem29" class="registerDisplay">000000</textarea>
            <br>
            <label>1E</label>
            <textarea cols="5" rows="1" disabled id="mem30" class="registerDisplay">000000</textarea>
            <br>
            <label>1F</label>
            <textarea cols="5" rows="1" disabled id="mem31" class="registerDisplay">000000</textarea>
            <br>
            
        </div>
        <div>
            <h3>Status</h3>
            <br>
            <input type="button" value="RUN" onclick="startRunning()">
            <br>
            <img src="assets/off.png" id="pausedLight"><label>Paused </label>
            <br>
            <img src="assets/off.png" id="stoppedLight"><label>Stopped </label>
            <br>
            <br>
            <h3>Program counter</h3>
            <textarea cols="10" rows="1" disabled class="counterDisplay" id="counterDisplay">0000000000000000</textarea>
            <h3>Stack pointer</h3>
            <textarea cols="10" rows="1" disabled class="counterDisplay" id="spDisplay">00000000</textarea>
            <h3>Input</h3>
            <input type="button" value="0" onclick="switchButton(this.value, this)" id="inputbutton0">
            <input type="button" value="0" onclick="switchButton(this.value, this)" id="inputbutton1">
            <input type="button" value="0" onclick="switchButton(this.value, this)" id="inputbutton2">
            <input type="button" value="0" onclick="switchButton(this.value, this)" id="inputbutton3">
            <input type="button" value="0" onclick="switchButton(this.value, this)" id="inputbutton4">
            <input type="button" value="0" onclick="switchButton(this.value, this)" id="inputbutton5">
            <input type="button" value="0" onclick="switchButton(this.value, this)" id="inputbutton6">
            <input type="button" value="0" onclick="switchButton(this.value, this)" id="inputbutton7">
            <br>
            <input type="button" value="Continue" onclick="resume()">
        </div>
        <div>
            <h3>Program</h3>
            <textarea name="" id="instructions" cols="24" rows="30" class="instructions"></textarea>
        </div>
        
        <div>
            <h3>Output</h3>
            <Canvas width="420px" height="240px" id="consoleOutput" style="font-family: ModernDOS;"></Canvas>
            <br>
            <Canvas width="320px" height="160px" id="pixelOutput" style="font-family: ModernDOS;"></Canvas>
            <br>
            <a href="https://treemaster134.github.io/BASL40">Assembler</a>
        </div>

    </div>
    
    <script>
        init();
        setDisplays();
        let ignoreIncrement = false;

        setInterval(update, 10);
        
        function update()
        {   
            ignoreIncrement = false;
            if(Registers["00"][0] == 0 && Registers["00"][1] == 0)
            {
                let brokenDownInstruction = instructions[programCounter].match(/.{1,8}/g);

                switch(brokenDownInstruction[0])
                {
                    case "00000000":
                        break;
                    case "00000001":
                        halt();
                        break;
                    case "00000011":
                        loadRegister(brokenDownInstruction[1]);
                        break;
                    case "00000100":
                        loadImmediate(brokenDownInstruction[1]);
                        break;
                    case "00000101":
                        store(brokenDownInstruction[1]);
                        break;
                    case "00000110":
                        move(brokenDownInstruction[1], brokenDownInstruction[2]);
                        break;
                    case "00000111":
                        swap(brokenDownInstruction[1], brokenDownInstruction[2]);
                        break;
                    case "00001000":
                        leftShift();
                        break;
                    case "00001001":
                        rightShift();
                        break;
                    case "00001010":
                        increment();
                        break;
                    case "00001011":
                        decrement();
                        break;
                    case "00001100":
                        addRegister(brokenDownInstruction[1]);
                        break;
                    case "00001101":
                        addImmediate(brokenDownInstruction[1]);
                        break;
                    case "00001110":
                        subRegister(brokenDownInstruction[1]);
                        break;
                    case "00001111":
                        subImmediate(brokenDownInstruction[1]);
                        break;
                    case "00011110":
                        output();
                        break;
                    case "00011101":
                        input();
                        break;
                    case "00010000":
                        jumpIfZero(brokenDownInstruction[1] + "" + brokenDownInstruction[2]);
                        break;
                    case "00010001":
                        jumpIfPositive(brokenDownInstruction[1] + "" + brokenDownInstruction[2]);
                        break;
                    case "00010010":
                        jumpIfNegative(brokenDownInstruction[1] + "" + brokenDownInstruction[2]);
                        break;
                    case "00010011":
                        jumpUnconditional(brokenDownInstruction[1] + "" + brokenDownInstruction[2]);
                        break;
                    case "00010100":
                        randomNumber(brokenDownInstruction[1], brokenDownInstruction[2]);
                        break;
                    case "00010101":
                        orImmediate(brokenDownInstruction[1]);
                        break;
                    case "00010110":
                        orRegister(brokenDownInstruction[1]);
                        break;
                    case "00011001":
                        xorImmediate(brokenDownInstruction[1]);
                        break;
                    case "00011010":
                        xorRegister(brokenDownInstruction[1]);
                        break;
                    case "00010111":
                        andImmediate(brokenDownInstruction[1]);
                        break;
                    case "00011000":
                        andRegister(brokenDownInstruction[1]);
                        break;
                    case "00000010":
                        wait();
                        break;
                    case "00011011":
                        stackPop();
                        break;
                    case "00011100":
                        stackPush();
                        break;
                    default:
                        break;
                        
                }
                
                if(ignoreIncrement == false){programCounter += 1;}
            }
            
            setDisplays();
        }
        /*
        ORI
        ORR

        XOI
        XOR

        ANI
        ANR

        */
        

    </script>
</body>
</html>